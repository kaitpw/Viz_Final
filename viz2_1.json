{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "data": [
    {
      "name": "source_1",
      "values": [
        {
          "COMBOSPH": 7708.951740078958,
          "state_name": "Alabama",
          "STATE_FIPS": 1
        },
        {
          "COMBOSPH": 19808.36106999495,
          "state_name": "Alaska",
          "STATE_FIPS": 2
        },
        {
          "COMBOSPH": 3461.2495908696797,
          "state_name": "Arizona",
          "STATE_FIPS": 4
        },
        {
          "COMBOSPH": 10689.054305713276,
          "state_name": "Arkansas",
          "STATE_FIPS": 5
        },
        {
          "COMBOSPH": 3999.8189985352774,
          "state_name": "California",
          "STATE_FIPS": 6
        },
        {
          "COMBOSPH": 13442.540891766026,
          "state_name": "Colorado",
          "STATE_FIPS": 8
        },
        {
          "COMBOSPH": 14217.425038383892,
          "state_name": "Connecticut",
          "STATE_FIPS": 9
        },
        {
          "COMBOSPH": 10510.972365800555,
          "state_name": "Delaware",
          "STATE_FIPS": 10
        },
        {
          "COMBOSPH": 5981.378166432223,
          "state_name": "District of Columbia",
          "STATE_FIPS": 11
        },
        {
          "COMBOSPH": 2175.5186750482712,
          "state_name": "Florida",
          "STATE_FIPS": 12
        },
        {
          "COMBOSPH": 8359.138343174067,
          "state_name": "Georgia",
          "STATE_FIPS": 13
        },
        {
          "COMBOSPH": 39.07605207066812,
          "state_name": "Hawaii",
          "STATE_FIPS": 15
        },
        {
          "COMBOSPH": 13682.978240052093,
          "state_name": "Idaho",
          "STATE_FIPS": 16
        },
        {
          "COMBOSPH": 17242.296571678027,
          "state_name": "Illinois",
          "STATE_FIPS": 17
        },
        {
          "COMBOSPH": 16298.200164697188,
          "state_name": "Indiana",
          "STATE_FIPS": 18
        },
        {
          "COMBOSPH": 17596.182570322824,
          "state_name": "Iowa",
          "STATE_FIPS": 19
        },
        {
          "COMBOSPH": 13717.993103213843,
          "state_name": "Kansas",
          "STATE_FIPS": 20
        },
        {
          "COMBOSPH": 11474.708598520734,
          "state_name": "Kentucky",
          "STATE_FIPS": 21
        },
        {
          "COMBOSPH": 4977.294465202316,
          "state_name": "Louisiana",
          "STATE_FIPS": 22
        },
        {
          "COMBOSPH": 14634.429800603086,
          "state_name": "Maine",
          "STATE_FIPS": 23
        },
        {
          "COMBOSPH": 11531.142365165952,
          "state_name": "Maryland",
          "STATE_FIPS": 24
        },
        {
          "COMBOSPH": 14114.377631334552,
          "state_name": "Massachusetts",
          "STATE_FIPS": 25
        },
        {
          "COMBOSPH": 19241.233871860095,
          "state_name": "Michigan",
          "STATE_FIPS": 26
        },
        {
          "COMBOSPH": 17881.07566844778,
          "state_name": "Minnesota",
          "STATE_FIPS": 27
        },
        {
          "COMBOSPH": 8525.335500412964,
          "state_name": "Mississippi",
          "STATE_FIPS": 28
        },
        {
          "COMBOSPH": 14410.483637014153,
          "state_name": "Missouri",
          "STATE_FIPS": 29
        },
        {
          "COMBOSPH": 14621.119936695042,
          "state_name": "Montana",
          "STATE_FIPS": 30
        },
        {
          "COMBOSPH": 14189.824301131694,
          "state_name": "Nebraska",
          "STATE_FIPS": 31
        },
        {
          "COMBOSPH": 6423.981385138819,
          "state_name": "Nevada",
          "STATE_FIPS": 32
        },
        {
          "COMBOSPH": 14873.01455855653,
          "state_name": "New Hampshire",
          "STATE_FIPS": 33
        },
        {
          "COMBOSPH": 14204.004306485736,
          "state_name": "New Jersey",
          "STATE_FIPS": 34
        },
        {
          "COMBOSPH": 10484.720669117973,
          "state_name": "New Mexico",
          "STATE_FIPS": 35
        },
        {
          "COMBOSPH": 12088.589105459112,
          "state_name": "New York",
          "STATE_FIPS": 36
        },
        {
          "COMBOSPH": 8322.41188954173,
          "state_name": "North Carolina",
          "STATE_FIPS": 37
        },
        {
          "COMBOSPH": 18029.809850015965,
          "state_name": "North Dakota",
          "STATE_FIPS": 38
        },
        {
          "COMBOSPH": 16017.408225839905,
          "state_name": "Ohio",
          "STATE_FIPS": 39
        },
        {
          "COMBOSPH": 11097.334800054301,
          "state_name": "Oklahoma",
          "STATE_FIPS": 40
        },
        {
          "COMBOSPH": 10026.177734230918,
          "state_name": "Oregon",
          "STATE_FIPS": 41
        },
        {
          "COMBOSPH": 14660.988323379366,
          "state_name": "Pennsylvania",
          "STATE_FIPS": 42
        },
        {
          "COMBOSPH": 16020.105703916312,
          "state_name": "Rhode Island",
          "STATE_FIPS": 44
        },
        {
          "COMBOSPH": 7007.551682947642,
          "state_name": "South Carolina",
          "STATE_FIPS": 45
        },
        {
          "COMBOSPH": 14882.239045923325,
          "state_name": "South Dakota",
          "STATE_FIPS": 46
        },
        {
          "COMBOSPH": 10021.481348531872,
          "state_name": "Tennessee",
          "STATE_FIPS": 47
        },
        {
          "COMBOSPH": 5875.019221299996,
          "state_name": "Texas",
          "STATE_FIPS": 48
        },
        {
          "COMBOSPH": 12637.839197404272,
          "state_name": "Utah",
          "STATE_FIPS": 49
        },
        {
          "COMBOSPH": 15024.847068643323,
          "state_name": "Vermont",
          "STATE_FIPS": 50
        },
        {
          "COMBOSPH": 9601.081641737881,
          "state_name": "Virginia",
          "STATE_FIPS": 51
        },
        {
          "COMBOSPH": 11337.589138033361,
          "state_name": "Washington",
          "STATE_FIPS": 53
        },
        {
          "COMBOSPH": 15537.783492703766,
          "state_name": "West Virginia",
          "STATE_FIPS": 54
        },
        {
          "COMBOSPH": 16002.83743012857,
          "state_name": "Wisconsin",
          "STATE_FIPS": 55
        },
        {
          "COMBOSPH": 16803.844557564043,
          "state_name": "Wyoming",
          "STATE_FIPS": 56
        }
      ]
    },
    {
      "name": "source_0",
      "url": "https://cdn.jsdelivr.net/npm/vega-datasets@v1.29.0/data/us-10m.json",
      "format": {"type": "topojson", "feature": "states"},
      "transform": [
        {
          "type": "lookup",
          "from": "source_1",
          "fields": ["id"],
          "key": "STATE_FIPS",
          "values": ["COMBOSPH", "state_name"]
        },
        {
          "type": "filter",
          "expr": "isValid(datum[\"COMBOSPH\"]) && isFinite(+datum[\"COMBOSPH\"])"
        }
      ]
    },
    {
      "name": "source_0_color_domain_COMBOSPH",
      "source": "source_0",
      "transform": [
        {"type": "formula", "expr": "+datum['COMBOSPH']", "as": "COMBOSPH"},
        {
          "type": "aggregate",
          "groupby": [],
          "fields": ["COMBOSPH", "COMBOSPH"],
          "ops": ["min", "max"],
          "as": ["min", "max"]
        }
      ]
    }
  ],
  "marks": [
    {
      "type": "shape",
      "name": "marks",
      "from": {"data": "source_0"},
      "encode": {
        "update": {
          "tooltip": {
            "signal": "{\"State\": isValid(datum[\"state_name\"]) ? datum[\"state_name\"] : \"\"+datum[\"state_name\"], \"Avg kWh\": format(datum[\"COMBOSPH\"], \".2f\")}"
          },
          "fill": {"field": "COMBOSPH", "scale": "color"},
          "stroke": {"value": "white"}
        }
      },
      "transform": [{"type": "geoshape", "projection": "projection"}],
      "style": ["geoshape"]
    }
  ],
  "scales": [
    {
      "name": "color",
      "type": "linear",
      "domain": [
        {"signal": "(data(\"source_0_color_domain_COMBOSPH\")[0] || {}).min"},
        {"signal": "(data(\"source_0_color_domain_COMBOSPH\")[0] || {}).max"}
      ],
      "range": {"scheme": "yelloworangered"},
      "interpolate": "hcl",
      "zero": false
    }
  ],
  "projections": [
    {
      "name": "projection",
      "type": "albersUsa",
      "size": {"signal": "[width, height]"},
      "fit": {"signal": "data('source_0')"}
    }
  ],
  "title": {
    "text": "Annual Heating Energy by State ",
    "align": "center",
    "frame": "group",
    "color": "black",
    "fontWeight": "bold",
    "fontSize": 15
  },
  "width": 350,
  "height": 250,
  "style": "view",
  "padding": 5,
  "legends": [
    {
      "title": "kWh/Household",
      "fill": "color",
      "gradientLength": {"signal": "clamp(height, 64, 200)"}
    }
  ],
  "background": "white"
}