{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "data": [
    {
      "name": "source_1",
      "values": [
        {
          "COMBOSPH": 5054.121632378813,
          "state_name": "Alabama",
          "STATE_FIPS": 1
        },
        {
          "COMBOSPH": 12753.753891505417,
          "state_name": "Alaska",
          "STATE_FIPS": 2
        },
        {
          "COMBOSPH": 2554.280949698204,
          "state_name": "Arizona",
          "STATE_FIPS": 4
        },
        {
          "COMBOSPH": 7447.020172953438,
          "state_name": "Arkansas",
          "STATE_FIPS": 5
        },
        {
          "COMBOSPH": 3573.1212611432134,
          "state_name": "California",
          "STATE_FIPS": 6
        },
        {
          "COMBOSPH": 11873.421300074542,
          "state_name": "Colorado",
          "STATE_FIPS": 8
        },
        {
          "COMBOSPH": 5773.143129066205,
          "state_name": "Connecticut",
          "STATE_FIPS": 9
        },
        {
          "COMBOSPH": 6839.984141727512,
          "state_name": "Delaware",
          "STATE_FIPS": 10
        },
        {
          "COMBOSPH": 4950.64723578801,
          "state_name": "District of Columbia",
          "STATE_FIPS": 11
        },
        {
          "COMBOSPH": 1132.6110191139544,
          "state_name": "Florida",
          "STATE_FIPS": 12
        },
        {
          "COMBOSPH": 6381.219934665417,
          "state_name": "Georgia",
          "STATE_FIPS": 13
        },
        {
          "COMBOSPH": 19.736391718874223,
          "state_name": "Hawaii",
          "STATE_FIPS": 15
        },
        {
          "COMBOSPH": 10836.945664996034,
          "state_name": "Idaho",
          "STATE_FIPS": 16
        },
        {
          "COMBOSPH": 14885.447189377723,
          "state_name": "Illinois",
          "STATE_FIPS": 17
        },
        {
          "COMBOSPH": 12661.747894189673,
          "state_name": "Indiana",
          "STATE_FIPS": 18
        },
        {
          "COMBOSPH": 13021.701946056552,
          "state_name": "Iowa",
          "STATE_FIPS": 19
        },
        {
          "COMBOSPH": 11661.902852642543,
          "state_name": "Kansas",
          "STATE_FIPS": 20
        },
        {
          "COMBOSPH": 7991.4107241625325,
          "state_name": "Kentucky",
          "STATE_FIPS": 21
        },
        {
          "COMBOSPH": 3465.4661419862787,
          "state_name": "Louisiana",
          "STATE_FIPS": 22
        },
        {
          "COMBOSPH": 3220.281383527653,
          "state_name": "Maine",
          "STATE_FIPS": 23
        },
        {
          "COMBOSPH": 8044.184914144628,
          "state_name": "Maryland",
          "STATE_FIPS": 24
        },
        {
          "COMBOSPH": 8464.476195894264,
          "state_name": "Massachusetts",
          "STATE_FIPS": 25
        },
        {
          "COMBOSPH": 16083.450734053617,
          "state_name": "Michigan",
          "STATE_FIPS": 26
        },
        {
          "COMBOSPH": 13437.657699817102,
          "state_name": "Minnesota",
          "STATE_FIPS": 27
        },
        {
          "COMBOSPH": 5447.467438884993,
          "state_name": "Mississippi",
          "STATE_FIPS": 28
        },
        {
          "COMBOSPH": 11254.31205620539,
          "state_name": "Missouri",
          "STATE_FIPS": 29
        },
        {
          "COMBOSPH": 11058.737996876755,
          "state_name": "Montana",
          "STATE_FIPS": 30
        },
        {
          "COMBOSPH": 11742.367133985039,
          "state_name": "Nebraska",
          "STATE_FIPS": 31
        },
        {
          "COMBOSPH": 5545.555411876427,
          "state_name": "Nevada",
          "STATE_FIPS": 32
        },
        {
          "COMBOSPH": 3778.918457031864,
          "state_name": "New Hampshire",
          "STATE_FIPS": 33
        },
        {
          "COMBOSPH": 11818.663660538641,
          "state_name": "New Jersey",
          "STATE_FIPS": 34
        },
        {
          "COMBOSPH": 9082.602790182538,
          "state_name": "New Mexico",
          "STATE_FIPS": 35
        },
        {
          "COMBOSPH": 8225.432430430363,
          "state_name": "New York",
          "STATE_FIPS": 36
        },
        {
          "COMBOSPH": 5508.336123649775,
          "state_name": "North Carolina",
          "STATE_FIPS": 37
        },
        {
          "COMBOSPH": 11549.184830337213,
          "state_name": "North Dakota",
          "STATE_FIPS": 38
        },
        {
          "COMBOSPH": 12672.085702418137,
          "state_name": "Ohio",
          "STATE_FIPS": 39
        },
        {
          "COMBOSPH": 8477.251397246635,
          "state_name": "Oklahoma",
          "STATE_FIPS": 40
        },
        {
          "COMBOSPH": 7466.935215128939,
          "state_name": "Oregon",
          "STATE_FIPS": 41
        },
        {
          "COMBOSPH": 9430.137539617413,
          "state_name": "Pennsylvania",
          "STATE_FIPS": 42
        },
        {
          "COMBOSPH": 9656.887481703765,
          "state_name": "Rhode Island",
          "STATE_FIPS": 44
        },
        {
          "COMBOSPH": 4580.038485801016,
          "state_name": "South Carolina",
          "STATE_FIPS": 45
        },
        {
          "COMBOSPH": 10621.874937547256,
          "state_name": "South Dakota",
          "STATE_FIPS": 46
        },
        {
          "COMBOSPH": 6889.422570336506,
          "state_name": "Tennessee",
          "STATE_FIPS": 47
        },
        {
          "COMBOSPH": 4221.940923968713,
          "state_name": "Texas",
          "STATE_FIPS": 48
        },
        {
          "COMBOSPH": 11958.823605197838,
          "state_name": "Utah",
          "STATE_FIPS": 49
        },
        {
          "COMBOSPH": 3522.33247471062,
          "state_name": "Vermont",
          "STATE_FIPS": 50
        },
        {
          "COMBOSPH": 6398.299388257397,
          "state_name": "Virginia",
          "STATE_FIPS": 51
        },
        {
          "COMBOSPH": 8068.251495891891,
          "state_name": "Washington",
          "STATE_FIPS": 53
        },
        {
          "COMBOSPH": 10654.191346787102,
          "state_name": "West Virginia",
          "STATE_FIPS": 54
        },
        {
          "COMBOSPH": 12670.506464166112,
          "state_name": "Wisconsin",
          "STATE_FIPS": 55
        },
        {
          "COMBOSPH": 13497.003135387999,
          "state_name": "Wyoming",
          "STATE_FIPS": 56
        }
      ]
    },
    {
      "name": "source_0",
      "url": "https://cdn.jsdelivr.net/npm/vega-datasets@v1.29.0/data/us-10m.json",
      "format": {"type": "topojson", "feature": "states"},
      "transform": [
        {
          "type": "lookup",
          "from": "source_1",
          "fields": ["id"],
          "values": ["COMBOSPH", "state_name"],
          "key": "STATE_FIPS"
        },
        {
          "type": "filter",
          "expr": "isValid(datum[\"COMBOSPH\"]) && isFinite(+datum[\"COMBOSPH\"])"
        }
      ]
    },
    {
      "name": "source_0_color_domain_COMBOSPH",
      "source": "source_0",
      "transform": [
        {"type": "formula", "expr": "+datum['COMBOSPH']", "as": "COMBOSPH"},
        {
          "type": "aggregate",
          "groupby": [],
          "fields": ["COMBOSPH", "COMBOSPH"],
          "ops": ["min", "max"],
          "as": ["min", "max"]
        }
      ]
    }
  ],
  "marks": [
    {
      "type": "shape",
      "name": "marks",
      "from": {"data": "source_0"},
      "encode": {
        "update": {
          "fill": {"field": "COMBOSPH", "scale": "color"},
          "stroke": {"value": "white"},
          "tooltip": {
            "signal": "{\"State\": isValid(datum[\"state_name\"]) ? datum[\"state_name\"] : \"\"+datum[\"state_name\"], \"Avg kWh\": format(datum[\"COMBOSPH\"], \".2f\")}"
          }
        }
      },
      "transform": [{"type": "geoshape", "projection": "projection"}],
      "style": ["geoshape"]
    }
  ],
  "scales": [
    {
      "name": "color",
      "type": "linear",
      "domain": [
        {"signal": "(data(\"source_0_color_domain_COMBOSPH\")[0] || {}).min"},
        {"signal": "(data(\"source_0_color_domain_COMBOSPH\")[0] || {}).max"}
      ],
      "range": {"scheme": "yelloworangered"},
      "interpolate": "hcl",
      "zero": false
    }
  ],
  "projections": [
    {
      "name": "projection",
      "size": {"signal": "[width, height]"},
      "fit": {"signal": "data('source_0')"},
      "type": "albersUsa"
    }
  ],
  "title": {
    "text": "Annual Heating Energy by State ",
    "align": "center",
    "fontWeight": "bold",
    "fontSize": 15,
    "frame": "group",
    "color": "black"
  },
  "background": "white",
  "padding": 5,
  "width": 350,
  "style": "view",
  "height": 250,
  "legends": [
    {
      "title": "kWh/Household",
      "fill": "color",
      "gradientLength": {"signal": "clamp(height, 64, 200)"}
    }
  ]
}